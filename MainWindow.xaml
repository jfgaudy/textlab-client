<Window x:Class="TextLabClient.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="TextLab Client" Height="600" Width="900"
        WindowStartupLocation="CenterScreen">
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>   <!-- Menu/Toolbar -->
            <RowDefinition Height="*"/>      <!-- Contenu principal -->
            <RowDefinition Height="Auto"/>   <!-- Status bar -->
        </Grid.RowDefinitions>
        
        <!-- Menu et Toolbar -->
        <DockPanel Grid.Row="0">
            <Menu DockPanel.Dock="Top">
                <MenuItem Header="_Fichier">
                    <MenuItem Name="ExitMenuItem" Header="_Quitter" Click="ExitMenuItem_Click"/>
                </MenuItem>
                <MenuItem Header="_Outils">
                    <MenuItem Name="SettingsMenuItem" Header="_Paramètres" Click="SettingsMenuItem_Click"/>
                    <MenuItem Name="TestConnectionMenuItem" Header="_Tester Connexion" Click="TestConnectionMenuItem_Click"/>
                </MenuItem>
                <MenuItem Header="_Aide">
                    <MenuItem Name="AboutMenuItem" Header="_À propos" Click="AboutMenuItem_Click"/>
                </MenuItem>
            </Menu>
            
            <ToolBar DockPanel.Dock="Top">
                <Button Name="RefreshButton" Content="🔄 Actualiser" Click="RefreshButton_Click"/>
                <Separator/>
                <Button Name="TestConnectionButton" Content="🔗 Test API" Click="TestConnectionButton_Click"/>
                <Separator/>
                <TextBlock Text="URL API:"/>
                <TextBox Name="ApiUrlTextBox" Width="300" Text="http://localhost:8000"/>
            </ToolBar>
        </DockPanel>
        
        <!-- Zone principale -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250"/>  <!-- Panneau gauche -->
                <ColumnDefinition Width="5"/>    <!-- Splitter -->
                <ColumnDefinition Width="*"/>    <!-- Zone principale -->
            </Grid.ColumnDefinitions>
            
            <!-- Panneau gauche - Navigation -->
            <Border Grid.Column="0" Background="#F5F5F5" BorderBrush="#DDD" BorderThickness="0,0,1,0">
                <DockPanel>
                    <TextBlock Text="Repositories" FontWeight="Bold" DockPanel.Dock="Top" 
                              Background="#E0E0E0" Padding="10,5"/>
                    <TreeView Name="RepositoriesTreeView" DockPanel.Dock="Fill"
                             SelectedItemChanged="RepositoriesTreeView_SelectedItemChanged">
                        <TreeView.ItemTemplate>
                            <HierarchicalDataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding DisplayName}" />
                                    <TextBlock Text="{Binding ItemCount}" Foreground="Gray" Margin="5,0,0,0"/>
                                </StackPanel>
                            </HierarchicalDataTemplate>
                        </TreeView.ItemTemplate>
                    </TreeView>
                </DockPanel>
            </Border>
            
            <!-- Splitter -->
            <GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Stretch" Background="#DDD"/>
            
            <!-- Zone principale -->
            <Border Grid.Column="2" Background="White">
                <DockPanel>
                    <!-- En-tête zone principale -->
                    <Border DockPanel.Dock="Top" Background="#F0F0F0" BorderBrush="#DDD" BorderThickness="0,0,0,1">
                        <TextBlock Name="MainContentHeader" Text="Bienvenue dans TextLab Client" 
                                  FontSize="16" FontWeight="Bold" Padding="15,10"/>
                    </Border>
                    
                    <!-- Contenu principal -->
                    <TabControl Name="MainTabControl" DockPanel.Dock="Fill">
                        <!-- Onglet Accueil -->
                        <TabItem Name="HomeTab" Header="🏠 Accueil" IsSelected="True">
                            <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <StackPanel Name="MainContentPanel" Margin="20">
                                    <!-- Zone de connexion -->
                                    <GroupBox Header="État de la Connexion" Margin="0,0,0,20">
                                        <StackPanel>
                                            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                                <TextBlock Text="Statut:" FontWeight="Bold" Width="80"/>
                                                <TextBlock Name="ConnectionStatusText" Text="Non testé" Foreground="Gray"/>
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                                <TextBlock Text="API URL:" FontWeight="Bold" Width="80"/>
                                                <TextBlock Name="CurrentApiUrlText" Text="-"/>
                                            </StackPanel>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="Version:" FontWeight="Bold" Width="80"/>
                                                <TextBlock Name="ApiVersionText" Text="-"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </GroupBox>
                                    
                                    <!-- Instructions -->
                                    <GroupBox Header="Instructions de Démarrage">
                                        <StackPanel>
                                            <TextBlock TextWrapping="Wrap" Margin="0,0,0,10">
                                                <Run Text="1. Vérifiez que l'API TextLab est démarrée"/>
                                                <LineBreak/>
                                                <Run Text="2. Configurez l'URL de l'API dans la barre d'outils"/>
                                                <LineBreak/>
                                                <Run Text="3. Cliquez sur 'Test API' pour vérifier la connexion"/>
                                                <LineBreak/>
                                                <Run Text="4. Une fois connecté, les repositories apparaîtront dans le panneau de gauche"/>
                                                <LineBreak/>
                                                <Run Text="5. Sélectionnez un repository pour voir ses documents"/>
                                            </TextBlock>
                                        </StackPanel>
                                    </GroupBox>
                                </StackPanel>
                            </ScrollViewer>
                        </TabItem>
                        
                        <!-- Onglet Documents -->
                        <TabItem Name="DocumentsTab" Header="📄 Documents" Visibility="Collapsed">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                
                                <!-- En-tête documents -->
                                <Border Grid.Row="0" Background="#F0F0F0" BorderBrush="#DDD" BorderThickness="0,0,0,1" Padding="15,10">
                                    <DockPanel>
                                        <StackPanel DockPanel.Dock="Left" Orientation="Horizontal">
                                            <TextBlock Name="DocumentsHeaderText" FontSize="16" FontWeight="Bold" 
                                                      Text="Documents" VerticalAlignment="Center"/>
                                            <TextBlock Name="DocumentsCountText" Text="" Foreground="Gray" 
                                                      Margin="10,0,0,0" VerticalAlignment="Center"/>
                                        </StackPanel>
                                        <StackPanel DockPanel.Dock="Right" Orientation="Horizontal">
                                            <Button Name="RefreshDocumentsButton" Content="🔄" Width="30" Height="30" 
                                                   ToolTip="Actualiser les documents" Click="RefreshDocumentsButton_Click"/>
                                            <Button Name="NewDocumentButton" Content="➕" Width="30" Height="30" 
                                                   ToolTip="Nouveau document" Margin="5,0,0,0" Click="NewDocumentButton_Click"/>
                                        </StackPanel>
                                    </DockPanel>
                                </Border>
                                
                                <!-- Liste documents -->
                                <DataGrid Name="DocumentsDataGrid" Grid.Row="1" 
                                         AutoGenerateColumns="False"
                                         CanUserAddRows="False"
                                         CanUserDeleteRows="False"
                                         IsReadOnly="True"
                                         GridLinesVisibility="Horizontal"
                                         HeadersVisibility="Column"
                                         SelectionMode="Single"
                                         SelectionChanged="DocumentsDataGrid_SelectionChanged"
                                         MouseDoubleClick="DocumentsDataGrid_MouseDoubleClick">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="📄" Binding="{Binding TypeIcon}" Width="30"/>
                                        <DataGridTextColumn Header="Titre" Binding="{Binding Title}" Width="300"/>
                                        <DataGridTextColumn Header="Catégorie" Binding="{Binding Category}" Width="120"/>
                                        <DataGridTextColumn Header="Modifié" Binding="{Binding UpdatedAt, StringFormat='{}{0:dd/MM/yyyy HH:mm}'}" Width="130"/>
                                        <DataGridTextColumn Header="Version" Binding="{Binding Version}" Width="80"/>
                                        <DataGridTextColumn Header="Chemin" Binding="{Binding GitPath}" Width="*"/>
                                    </DataGrid.Columns>
                                    
                                    <DataGrid.RowStyle>
                                        <Style TargetType="DataGridRow">
                                            <Setter Property="ToolTip" Value="{Binding Title}"/>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="#E3F2FD"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </DataGrid.RowStyle>
                                </DataGrid>
                            </Grid>
                        </TabItem>
                    </TabControl>
                </DockPanel>
            </Border>
        </Grid>
        
        <!-- Status bar -->
        <StatusBar Grid.Row="2">
            <StatusBarItem>
                <TextBlock Name="StatusText" Text="Prêt"/>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock Name="LastUpdateText" Text=""/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window> 